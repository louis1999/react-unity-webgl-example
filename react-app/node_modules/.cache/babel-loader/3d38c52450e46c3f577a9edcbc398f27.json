{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useUnityLoader = void 0;\n\nvar react_1 = require(\"react\");\n\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\n\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\n\n\nvar useUnityLoader = function (source) {\n  var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading),\n      status = _a[0],\n      setStatus = _a[1]; // Effect hook will be invoked when the source changes.\n\n\n  (0, react_1.useEffect)(function () {\n    // It is possible for the application being rendered server side. In\n    // this scenario, the window is not available. We can't create a Unity\n    // Loader in this case.\n    if (is_browser_environment_1.isBrowserEnvironment === false) {\n      return;\n    } // If the script's source is null, we'll reset the status to idle.\n\n\n    if (source === null) {\n      setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n      return;\n    }\n    /**\n     * Find existing script element by source. It may have been added by\n     * another instance of this hook.\n     */\n\n\n    var script = window.document.querySelector(\"script[src=\\\"\".concat(source, \"\\\"]\")); // If there wan't another instance of this script, we're going to create a\n    // new one with the provided source.\n\n    if (script === null) {\n      script = window.document.createElement(\"script\");\n      script.src = source;\n      script.async = true;\n      script.setAttribute(\"data-status\", \"loading\"); // Add script to window.document body.\n\n      window.document.body.appendChild(script); // Store status in attribute on script. This can be read by other\n      // instances of this hook.\n\n      script.addEventListener(\"load\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n      });\n      script.addEventListener(\"error\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n      });\n    } else {\n      // If there already was a script with the same source, grab its existing\n      // script status from attribute and set to state.\n      setStatus(script.getAttribute(\"data-status\") === \"loaded\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    }\n    /**\n     * Script event handler to update status in state. Even if the script\n     * already exists we still need to add event handlers to update the state\n     * for this hook instance.\n     * @param event The event that was triggered.\n     */\n\n\n    var setStateFromEvent = function (event) {\n      return setStatus(event.type === \"load\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    };\n\n    script.addEventListener(\"load\", setStateFromEvent);\n    script.addEventListener(\"error\", setStateFromEvent); // Remove event listeners on cleanup.\n\n    return function () {\n      if (script !== null) {\n        script.removeEventListener(\"load\", setStateFromEvent);\n        script.removeEventListener(\"error\", setStateFromEvent);\n        window.document.body.removeChild(script);\n      }\n    };\n  }, [source]);\n  return status;\n};\n\nexports.useUnityLoader = useUnityLoader;","map":{"version":3,"names":["Object","defineProperty","exports","value","useUnityLoader","react_1","require","is_browser_environment_1","unity_loader_status_1","source","_a","useState","UnityLoaderStatus","Loading","status","setStatus","useEffect","isBrowserEnvironment","Idle","script","window","document","querySelector","concat","createElement","src","async","setAttribute","body","appendChild","addEventListener","getAttribute","Loaded","Error","setStateFromEvent","event","type","removeEventListener","removeChild"],"sources":["/Users/louisdaisomont/Desktop/tuto-react-unity-webgl/react-app/node_modules/react-unity-webgl/distribution/hooks/use-unity-loader.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useUnityLoader = void 0;\nvar react_1 = require(\"react\");\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\nvar useUnityLoader = function (source) {\n    var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading), status = _a[0], setStatus = _a[1];\n    // Effect hook will be invoked when the source changes.\n    (0, react_1.useEffect)(function () {\n        // It is possible for the application being rendered server side. In\n        // this scenario, the window is not available. We can't create a Unity\n        // Loader in this case.\n        if (is_browser_environment_1.isBrowserEnvironment === false) {\n            return;\n        }\n        // If the script's source is null, we'll reset the status to idle.\n        if (source === null) {\n            setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n            return;\n        }\n        /**\n         * Find existing script element by source. It may have been added by\n         * another instance of this hook.\n         */\n        var script = window.document.querySelector(\"script[src=\\\"\".concat(source, \"\\\"]\"));\n        // If there wan't another instance of this script, we're going to create a\n        // new one with the provided source.\n        if (script === null) {\n            script = window.document.createElement(\"script\");\n            script.src = source;\n            script.async = true;\n            script.setAttribute(\"data-status\", \"loading\");\n            // Add script to window.document body.\n            window.document.body.appendChild(script);\n            // Store status in attribute on script. This can be read by other\n            // instances of this hook.\n            script.addEventListener(\"load\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n            });\n            script.addEventListener(\"error\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n            });\n        }\n        else {\n            // If there already was a script with the same source, grab its existing\n            // script status from attribute and set to state.\n            setStatus(script.getAttribute(\"data-status\") === \"loaded\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        }\n        /**\n         * Script event handler to update status in state. Even if the script\n         * already exists we still need to add event handlers to update the state\n         * for this hook instance.\n         * @param event The event that was triggered.\n         */\n        var setStateFromEvent = function (event) {\n            return setStatus(event.type === \"load\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        };\n        script.addEventListener(\"load\", setStateFromEvent);\n        script.addEventListener(\"error\", setStateFromEvent);\n        // Remove event listeners on cleanup.\n        return function () {\n            if (script !== null) {\n                script.removeEventListener(\"load\", setStateFromEvent);\n                script.removeEventListener(\"error\", setStateFromEvent);\n                window.document.body.removeChild(script);\n            }\n        };\n    }, [source]);\n    return status;\n};\nexports.useUnityLoader = useUnityLoader;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}